# BlueKing Lite 对外接口和数据推送能力说明

> 文档版本：v1.0
> 创建日期：2025-10-21
> 适用版本：BlueKing Lite 当前版本

## 概述

BlueKing Lite 提供了完善的对外数据接口和推送能力，支持与其他平台和应用进行双向数据对接。本文档详细介绍平台的 REST API 接口体系、数据推送渠道、认证机制和接入方法。

## 一、对外 REST API 接口

### 1.1 接口架构

- **基础路径**：`http://<服务地址>/api/v1/<模块名>/`
- **协议**：HTTP/HTTPS
- **数据格式**：JSON
- **认证方式**：Bearer Token / API Secret
- **框架**：Django REST Framework

### 1.2 核心模块接口清单

#### 1.2.1 告警模块 (`/api/v1/alerts/`)

| 端点路径 | HTTP 方法 | 功能说明 |
|---------|----------|---------|
| `/api/v1/alerts/api/alert_source/` | GET, POST, PUT, DELETE | 告警源管理 |
| `/api/v1/alerts/api/alerts/` | GET, POST, PUT, DELETE | 告警信息 CRUD |
| `/api/v1/alerts/api/events/` | GET, POST, PUT, DELETE | 事件管理 |
| `/api/v1/alerts/api/level/` | GET, POST, PUT, DELETE | 告警等级管理 |
| `/api/v1/alerts/api/assignment/` | GET, POST, PUT, DELETE | 告警分派 |
| `/api/v1/alerts/api/shield/` | GET, POST, PUT, DELETE | 告警屏蔽 |
| `/api/v1/alerts/api/incident/` | GET, POST, PUT, DELETE | 事故管理 |
| `/api/v1/alerts/api/correlation_rule/` | GET, POST, PUT, DELETE | 关联规则 |
| `/api/v1/alerts/api/aggregation_rule/` | GET, POST, PUT, DELETE | 聚合规则 |
| `/api/v1/alerts/api/log/` | GET | 系统日志查询 |

**实现位置**：`server/apps/alerts/urls.py`

#### 1.2.2 CMDB 模块 (`/api/v1/cmdb/`)

| 端点路径 | HTTP 方法 | 功能说明 |
|---------|----------|---------|
| `/api/v1/cmdb/api/classification/` | GET, POST, PUT, DELETE | 模型分类管理 |
| `/api/v1/cmdb/api/model/` | GET, POST, PUT, DELETE | 模型管理 |
| `/api/v1/cmdb/api/instance/` | GET, POST, PUT, DELETE | 资源实例管理 |
| `/api/v1/cmdb/api/change_record/` | GET | 变更记录查询 |
| `/api/v1/cmdb/api/collect/` | GET, POST, PUT, DELETE | 采集管理 |

**实现位置**：`server/apps/cmdb/urls.py`

#### 1.2.3 监控模块 (`/api/v1/monitor/`)

| 端点路径 | HTTP 方法 | 功能说明 |
|---------|----------|---------|
| `/api/v1/monitor/api/monitor_object/` | GET, POST, PUT, DELETE | 监控对象管理 |
| `/api/v1/monitor/api/metrics/` | GET, POST, PUT, DELETE | 指标管理 |
| `/api/v1/monitor/api/monitor_policy/` | GET, POST, PUT, DELETE | 监控策略管理 |
| `/api/v1/monitor/api/monitor_alert/` | GET, POST, PUT, DELETE | 监控告警管理 |

**实现位置**：`server/apps/monitor/urls.py`

#### 1.2.4 OpsPilot AI 助手模块 (`/api/v1/opspilot/`)

**OpenAI 兼容接口**（重点推荐）：

| 端点路径 | HTTP 方法 | 功能说明 |
|---------|----------|---------|
| `/api/v1/opspilot/bot_mgmt/v1/chat/completions` | POST | OpenAI 标准聊天接口 |
| `/api/v1/opspilot/bot_mgmt/lobe_chat/v1/chat/completions` | POST | Lobe Chat 兼容接口 |
| `/api/v1/opspilot/bot_mgmt/bot/{bot_id}/get_detail/` | GET | 获取 Bot 详情 |
| `/api/v1/opspilot/bot_mgmt/skill_execute/` | POST | 执行 Bot 技能 |

**标准 REST API**：

| 端点路径 | HTTP 方法 | 功能说明 |
|---------|----------|---------|
| `/api/v1/opspilot/model_provider_mgmt/` | GET, POST, PUT, DELETE | 模型提供商管理 |
| `/api/v1/opspilot/bot_mgmt/bot/` | GET, POST, PUT, DELETE | Bot 管理 |
| `/api/v1/opspilot/knowledge_mgmt/` | GET, POST, PUT, DELETE | 知识库管理 |

**实现位置**：`server/apps/opspilot/urls.py`, `server/apps/opspilot/views.py`

#### 1.2.5 节点管理模块 (`/api/v1/node_mgmt/`)

提供节点生命周期管理、配置管理等 API。

**实现位置**：`server/apps/node_mgmt/urls.py`

#### 1.2.6 日志模块 (`/api/v1/log/`)

提供日志查询、分析等 API。

#### 1.2.7 基础服务模块 (`/api/v1/base/`)

| 端点路径 | HTTP 方法 | 功能说明 |
|---------|----------|---------|
| `/api/v1/base/user_api_secret/` | GET, POST, DELETE | API 密钥管理 |
| `/api/v1/base/user_api_secret/generate_api_secret/` | POST | 生成新的 API 密钥 |

**实现位置**：`server/apps/base/urls.py`

#### 1.2.8 认证相关 (`/api/v1/core/`)

| 端点路径 | HTTP 方法 | 功能说明 |
|---------|----------|---------|
| `/api/v1/core/api/login/` | POST | 用户登录 |
| `/api/v1/core/api/bk_lite_login/` | POST | 蓝鲸登录 |
| `/api/v1/core/api/get_user_menus/` | GET | 获取用户菜单 |
| `/api/v1/core/api/get_domain_list/` | GET | 获取域列表 |
| `/api/v1/core/health/` | GET | 健康检查 |

**实现位置**：`server/apps/core/urls.py`

---

## 二、数据推送能力

### 2.1 告警通知推送系统

BlueKing Lite 内置了完善的告警通知推送系统，支持多种推送渠道。

#### 2.1.1 支持的推送渠道

| 渠道类型 | 渠道代码 | 功能说明 |
|---------|---------|---------|
| 邮件推送 | `EMAIL` | 支持 SMTP/SMTP_SSL/TLS 协议 |
| 企业微信 | `ENTERPRISE_WECHAT` | 官方 SDK 集成，支持发送文本、markdown、图文消息 |
| 企业微信机器人 | `ENTERPRISE_WECHAT_BOT` | Webhook 推送，支持文本和 markdown 格式 |

#### 2.1.2 推送配置

**邮件推送配置**：
```python
{
    "smtp_server": "smtp.example.com",
    "smtp_port": 465,
    "smtp_user": "noreply@example.com",
    "smtp_password": "password",
    "from_addr": "noreply@example.com",
    "use_ssl": True,  # 或 use_tls
}
```

**企业微信推送配置**：
```python
{
    "corp_id": "企业 ID",
    "agent_id": "应用 AgentID",
    "secret": "应用 Secret"
}
```

**企业微信机器人配置**：
```python
{
    "webhook_url": "https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=xxx"
}
```

#### 2.1.3 推送触发方式

1. **告警规则自动触发**：告警产生时根据配置的通知策略自动推送
2. **API 调用触发**：通过 NATS RPC API 主动调用推送

#### 2.1.4 核心实现文件

```
server/apps/alerts/
├── common/notify/
│   ├── notify.py              # 通知发送核心逻辑
│   └── base.py                # 通知消息格式化
├── service/notify_service.py  # 推送服务编排
└── tasks.py                   # Celery 异步任务

server/apps/system_mgmt/
├── utils/channel_utils.py     # 推送渠道具体实现
│   ├── send_email()          # 邮件发送
│   ├── send_wechat()         # 企业微信发送
│   └── send_by_bot()         # 机器人推送
└── models/channel.py          # 推送渠道模型
```

### 2.2 Webhook 接收接口

BlueKing Lite 支持接收外部系统推送的告警数据，如 Prometheus、Zabbix、自定义监控系统等。

#### 2.2.1 接收端点

**URL**：`POST /api/v1/alerts/api/receiver_data/`

#### 2.2.2 认证方式

通过 `secret` 密钥进行认证，支持两种传递方式：
- **HTTP Header**：`HTTP_SECRET: your_secret`
- **Request Body**：`{"secret": "your_secret"}`

#### 2.2.3 请求格式

```json
{
  "source_type": "monitor",
  "source_id": "monitor_source_001",
  "secret": "your_webhook_secret",
  "events": [
    {
      "title": "CPU 使用率过高",
      "description": "服务器 server-01 的 CPU 使用率超过 80%",
      "level": "critical",
      "start_time": "2025-10-21T10:00:00Z",
      "end_time": "2025-10-21T10:05:00Z",
      "labels": {
        "instance": "server-01",
        "region": "cn-south"
      },
      "annotations": {
        "alertname": "HighCPUUsage",
        "summary": "CPU usage exceeded threshold"
      },
      "event_id": "evt-12345",
      "external_id": "ext-67890",
      "status": "firing"
    }
  ]
}
```

#### 2.2.4 字段说明

| 字段 | 类型 | 必填 | 说明 |
|-----|------|-----|------|
| `source_type` | string | 是 | 告警源类型（monitor/prometheus/webhook） |
| `source_id` | string | 是 | 告警源 ID（需先在系统中创建） |
| `secret` | string | 是 | 认证密钥 |
| `events` | array | 是 | 事件列表 |
| `events[].title` | string | 是 | 事件标题 |
| `events[].description` | string | 否 | 事件描述 |
| `events[].level` | string | 是 | 告警等级（critical/warning/info） |
| `events[].start_time` | string | 是 | 开始时间（ISO 8601 格式） |
| `events[].end_time` | string | 否 | 结束时间 |
| `events[].labels` | object | 否 | 标签键值对 |
| `events[].annotations` | object | 否 | 注解键值对 |
| `events[].event_id` | string | 否 | 事件 ID |
| `events[].external_id` | string | 否 | 外部系统 ID |
| `events[].status` | string | 否 | 状态（firing/resolved） |

#### 2.2.5 响应格式

**成功响应**：
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "received": 1,
    "created": 1
  }
}
```

**失败响应**：
```json
{
  "code": 400,
  "message": "Invalid secret",
  "data": null
}
```

#### 2.2.6 实现位置

- `server/apps/alerts/views/source.py` - Webhook 接收视图
- `server/apps/alerts/common/source_adapter/webhook.py` - Webhook 适配器

### 2.3 NATS 消息队列推送

BlueKing Lite 使用 NATS 作为内部消息队列，也可用于与外部系统集成。

#### 2.3.1 NATS RPC API

**实现位置**：`server/apps/system_mgmt/nats_api.py`

#### 2.3.2 提供的 RPC 服务

```python
# 发送消息到指定渠道
@nats_client.register
def send_msg_with_channel(channel_id, title, content, receivers):
    """
    参数：
      - channel_id: 推送渠道 ID
      - title: 消息标题
      - content: 消息内容（支持 HTML）
      - receivers: 接收者用户 ID 列表
    返回：发送结果
    """
    pass

# Token 验证和权限查询
@nats_client.register
def verify_token(token):
    """验证 JWT Token 并返回用户信息"""
    pass

# 获取用户菜单
@nats_client.register
def get_user_menus(username):
    """获取指定用户的菜单权限"""
    pass
```

#### 2.3.3 NATS 配置

在 `server/.env` 中配置：
```bash
NATS_SERVER=nats://localhost:4222
```

#### 2.3.4 使用场景

- 异步任务执行（SSH 命令执行、云资源采集）
- 跨服务通信
- 事件驱动的消息推送

---

## 三、API 认证机制

BlueKing Lite 提供 3 种 API 认证方式，满足不同场景需求。

### 3.1 方式一：API Secret（推荐用于外部应用对接）

#### 3.1.1 生成 API Secret

**步骤 1：调用登录接口获取 Token**
```bash
curl -X POST http://localhost:18001/api/v1/core/api/login/ \
  -H "Content-Type: application/json" \
  -d '{
    "username": "admin",
    "password": "your_password",
    "domain": "domain.com"
  }'
```

**步骤 2：使用 Token 生成 API Secret**
```bash
curl -X POST http://localhost:18001/api/v1/base/user_api_secret/generate_api_secret/ \
  -H "Authorization: Bearer <登录返回的token>" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "第三方应用接入",
    "description": "用于 XX 系统调用 BlueKing API"
  }'
```

**响应示例**：
```json
{
  "code": 0,
  "data": {
    "id": 1,
    "name": "第三方应用接入",
    "api_secret": "bkls_xxxxxxxxxxxxxxxxxxxx",
    "created_at": "2025-10-21T10:00:00Z"
  }
}
```

#### 3.1.2 使用 API Secret

在后续 API 请求中使用 `Authorization` 头：
```bash
curl -X GET http://localhost:18001/api/v1/alerts/api/alerts/ \
  -H "Authorization: Bearer bkls_xxxxxxxxxxxxxxxxxxxx"
```

#### 3.1.3 管理 API Secret

**查看已有 Secret**：
```bash
GET /api/v1/base/user_api_secret/
```

**删除 Secret**：
```bash
DELETE /api/v1/base/user_api_secret/{id}/
```

#### 3.1.4 实现位置

- `server/apps/base/user_api_secret_mgmt/views.py` - API 密钥管理视图
- `server/apps/base/user_api_secret_mgmt/models.py` - UserAPISecret 模型

### 3.2 方式二：JWT Token（用于系统管理员）

#### 3.2.1 Token 生成

系统管理模块使用 PyJWT 生成 Token：
```python
import jwt
from datetime import datetime, timedelta

payload = {
    'user_id': user.id,
    'username': user.username,
    'exp': datetime.utcnow() + timedelta(hours=24)
}
token = jwt.encode(payload, SECRET_KEY, algorithm='HS256')
```

#### 3.2.2 使用方式

```bash
curl -X GET http://localhost:18001/api/v1/core/api/get_user_menus/ \
  -H "Authorization: Basic <jwt_token>"
```

#### 3.2.3 实现位置

- `server/apps/system_mgmt/nats_api.py` - Token 验证逻辑

### 3.3 方式三：Webhook Secret（用于告警数据接收）

#### 3.3.1 配置 Secret

在创建告警源时配置 `secret` 字段：
```json
{
  "name": "Prometheus 告警源",
  "source_type": "prometheus",
  "secret": "your_webhook_secret_key"
}
```

#### 3.3.2 使用方式

在推送告警数据时携带 secret：
```bash
curl -X POST http://localhost:18001/api/v1/alerts/api/receiver_data/ \
  -H "Content-Type: application/json" \
  -H "HTTP_SECRET: your_webhook_secret_key" \
  -d '{...}'
```

或在请求体中包含：
```json
{
  "secret": "your_webhook_secret_key",
  "events": [...]
}
```

### 3.4 认证方式对比

| 认证方式 | 适用场景 | 有效期 | 权限范围 | 生成方式 |
|---------|---------|--------|---------|---------|
| API Secret | 外部应用对接 | 长期有效 | 用户级别 | Web UI 或 API 生成 |
| JWT Token | 系统管理、临时访问 | 可配置（默认 24h） | 用户级别 | 登录接口返回 |
| Webhook Secret | 接收外部告警 | 长期有效 | 告警源级别 | 创建告警源时配置 |

---

## 四、数据导出功能

### 4.1 CMDB 数据导出

BlueKing Lite 提供了完善的 CMDB 数据导出功能，支持导出为 Excel 格式。

#### 4.1.1 功能特性

- ✅ 支持导出模板生成
- ✅ 支持实例列表导出
- ✅ 支持枚举字段、组织、用户字段
- ✅ 支持关联关系导出
- ✅ Excel 格式（`.xlsx`）

#### 4.1.2 实现位置

- `server/apps/cmdb/utils/export.py` - 导出核心逻辑（Export 类）
- `server/apps/cmdb/views/instance.py` - 导出 API 视图

#### 4.1.3 使用方式

通过 CMDB 实例管理 API 的导出 action：
```bash
GET /api/v1/cmdb/api/instance/{model_id}/export/
```

#### 4.1.4 导出文件格式

生成的 Excel 文件包含：
- 字段名称和描述
- 数据类型和约束
- 实例数据
- 关联关系数据

---

## 五、OpenAI 兼容 API 使用指南

BlueKing Lite 的 OpsPilot 模块提供了与 OpenAI API 兼容的接口，方便与各类 AI 应用集成。

### 5.1 接口端点

**标准接口**：
```
POST /api/v1/opspilot/bot_mgmt/v1/chat/completions
```

**Lobe Chat 接口**：
```
POST /api/v1/opspilot/bot_mgmt/lobe_chat/v1/chat/completions
```

### 5.2 认证方式

使用 API Secret 进行认证：
```bash
Authorization: Bearer bkls_xxxxxxxxxxxxxxxxxxxx
```

### 5.3 请求格式

```json
{
  "model": "bot_id",
  "messages": [
    {
      "role": "user",
      "content": "帮我查看服务器状态"
    }
  ],
  "stream": false
}
```

### 5.4 响应格式

```json
{
  "id": "chatcmpl-xxx",
  "object": "chat.completion",
  "created": 1698765432,
  "model": "bot_id",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "服务器运行正常..."
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 10,
    "completion_tokens": 20,
    "total_tokens": 30
  }
}
```

### 5.5 集成示例

**Python 示例**：
```python
import requests

url = "http://localhost:18001/api/v1/opspilot/bot_mgmt/v1/chat/completions"
headers = {
    "Authorization": "Bearer bkls_xxxxxxxxxxxxxxxxxxxx",
    "Content-Type": "application/json"
}
data = {
    "model": "ops-bot-001",
    "messages": [{"role": "user", "content": "查询服务器状态"}],
    "stream": False
}

response = requests.post(url, json=data, headers=headers)
print(response.json())
```

### 5.6 实现位置

- `server/apps/opspilot/views.py` - OpenAI 兼容接口实现
- `server/apps/opspilot/urls.py` - 路由配置

---

## 六、快速接入示例

### 6.1 场景一：第三方系统获取告警列表

```python
import requests

# 1. 生成 API Secret（在 Web UI 或通过 API）
api_secret = "bkls_xxxxxxxxxxxxxxxxxxxx"

# 2. 调用告警列表接口
url = "http://localhost:18001/api/v1/alerts/api/alerts/"
headers = {
    "Authorization": f"Bearer {api_secret}",
    "Content-Type": "application/json"
}
params = {
    "page": 1,
    "page_size": 20,
    "level": "critical"
}

response = requests.get(url, headers=headers, params=params)
alerts = response.json()

for alert in alerts['data']['results']:
    print(f"告警: {alert['title']}, 等级: {alert['level']}")
```

### 6.2 场景二：Prometheus 推送告警到 BlueKing

**Step 1：在 BlueKing 中创建 Prometheus 告警源**
- 登录 BlueKing Lite
- 进入"告警管理" -> "告警源"
- 创建新告警源，类型选择 "Prometheus"
- 记录生成的 `source_id` 和 `secret`

**Step 2：配置 Prometheus Alertmanager**

编辑 `alertmanager.yml`：
```yaml
route:
  receiver: 'blueking'

receivers:
  - name: 'blueking'
    webhook_configs:
      - url: 'http://your-blueking-server:18001/api/v1/alerts/api/receiver_data/'
        send_resolved: true
        http_config:
          headers:
            HTTP_SECRET: 'your_webhook_secret'
```

**Step 3：配置告警数据转换（可选）**

如需自定义数据格式，可使用中间服务转换 Prometheus 告警格式为 BlueKing 格式。

### 6.3 场景三：企业微信接收 BlueKing 告警

**Step 1：创建企业微信应用**
- 登录企业微信管理后台
- 创建自建应用，获取 `corp_id`、`agent_id`、`secret`

**Step 2：在 BlueKing 中配置推送渠道**
- 进入"系统管理" -> "通知渠道"
- 添加企业微信渠道
- 填入企业微信配置信息

**Step 3：配置告警通知策略**
- 进入"告警管理" -> "通知策略"
- 创建策略，选择企业微信渠道
- 配置接收人和推送条件

### 6.4 场景四：使用 OpsPilot AI Bot

```python
import requests

# OpenAI 兼容接口调用
url = "http://localhost:18001/api/v1/opspilot/bot_mgmt/v1/chat/completions"
headers = {
    "Authorization": "Bearer bkls_xxxxxxxxxxxxxxxxxxxx",
    "Content-Type": "application/json"
}
data = {
    "model": "ops-assistant-bot",
    "messages": [
        {"role": "user", "content": "查询今天的告警统计"}
    ],
    "stream": False
}

response = requests.post(url, json=data, headers=headers)
result = response.json()
print(result['choices'][0]['message']['content'])
```

---

## 七、关键文件路径索引

### 7.1 核心接口实现

```
server/
├── urls.py                                    # 主 URL 配置（自动注册所有模块 API）
├── apps/
│   ├── alerts/
│   │   ├── urls.py                           # 告警模块路由
│   │   ├── views/source.py                   # Webhook 接收器
│   │   ├── common/
│   │   │   ├── notify/notify.py             # 通知发送核心
│   │   │   └── source_adapter/webhook.py    # Webhook 适配器
│   │   └── service/notify_service.py        # 推送服务
│   ├── cmdb/
│   │   ├── urls.py                           # CMDB 路由
│   │   ├── utils/export.py                   # 数据导出
│   │   └── views/instance.py                 # 实例视图（含导出）
│   ├── monitor/
│   │   └── urls.py                           # 监控路由
│   ├── opspilot/
│   │   ├── urls.py                           # OpsPilot 路由
│   │   └── views.py                          # OpenAI 兼容接口
│   ├── base/
│   │   ├── urls.py                           # 基础服务路由
│   │   └── user_api_secret_mgmt/
│   │       ├── views.py                      # API 密钥管理
│   │       └── models.py                     # UserAPISecret 模型
│   ├── system_mgmt/
│   │   ├── nats_api.py                       # NATS RPC API
│   │   ├── utils/channel_utils.py            # 推送渠道实现
│   │   └── models/channel.py                 # 推送渠道模型
│   └── core/
│       ├── urls.py                           # 认证相关路由
│       └── middlewares/api_middleware.py     # API 中间件
```

### 7.2 配置文件

```
server/
├── .env                                       # 环境变量配置
├── settings.py                                # Django 设置入口
└── config/
    └── components/                            # 分模块配置
```

### 7.3 文档

```
docs-website/docs/products/
├── alert/                                     # 告警模块文档
│   ├── feature.md
│   └── index.md
├── opspilot/                                  # OpsPilot 文档
│   ├── introduce.md
│   └── capabities.md
└── cmdb/                                      # CMDB 文档
    ├── feature.md
    └── index.md
```

---

## 八、常见问题 FAQ

### Q1：如何测试 API 是否正常工作？

**A**：可以先调用健康检查接口：
```bash
curl http://localhost:18001/api/v1/core/health/
```

返回 `{"status": "ok"}` 表示服务正常。

### Q2：API Secret 和 JWT Token 有什么区别？

**A**：
- **API Secret**：长期有效，适合外部应用持续调用，需要手动生成和管理
- **JWT Token**：短期有效（默认 24 小时），通过登录接口获取，适合临时访问

### Q3：如何查看 API 的详细参数说明？

**A**：BlueKing Lite 使用 Django REST Framework，可以：
1. 访问 `http://localhost:18001/api/v1/<模块>/` 查看可浏览的 API 文档
2. 查看源代码中的 ViewSet 和 Serializer 定义

### Q4：推送消息失败如何排查？

**A**：
1. 检查推送渠道配置是否正确（企业微信 ID、SMTP 配置等）
2. 查看 Celery 日志：`docker logs <celery-container>`
3. 查看 server 日志：`tail -f server/logs/server.log`

### Q5：Webhook 接收接口返回 403 如何解决？

**A**：
1. 确认告警源已在系统中创建
2. 检查 `secret` 是否正确
3. 确认 `source_id` 与告警源 ID 匹配

### Q6：支持批量导出数据吗？

**A**：是的，CMDB 模块支持批量导出实例数据为 Excel 格式。其他模块可通过 API 分页查询后自行处理导出。

### Q7：如何限制 API 调用频率？

**A**：可在 Django 设置中配置 REST Framework 的 Throttling：
```python
REST_FRAMEWORK = {
    'DEFAULT_THROTTLE_CLASSES': [
        'rest_framework.throttling.AnonRateThrottle',
        'rest_framework.throttling.UserRateThrottle'
    ],
    'DEFAULT_THROTTLE_RATES': {
        'anon': '100/day',
        'user': '1000/day'
    }
}
```

---

## 九、安全建议

### 9.1 API Secret 管理

- ✅ 定期轮换 API Secret
- ✅ 不同应用使用不同的 Secret
- ✅ 妥善保管，不要提交到代码库
- ✅ 删除不再使用的 Secret

### 9.2 网络安全

- ✅ 生产环境使用 HTTPS
- ✅ 配置防火墙，限制 API 访问源 IP
- ✅ 使用 Nginx 反向代理，配置访问频率限制
- ✅ 启用 CORS 配置，限制跨域访问

### 9.3 数据安全

- ✅ 敏感数据推送使用加密传输
- ✅ 日志中脱敏敏感信息（密码、Token）
- ✅ 定期审计 API 访问日志

---

## 十、技术支持

如有疑问或需要技术支持，请通过以下方式联系：

- **项目地址**：https://github.com/TencentBlueKing/bk-lite
- **问题反馈**：https://github.com/TencentBlueKing/bk-lite/issues
- **开发文档**：查看项目 `DEVELOPMENT.md`

---

## 附录：版本历史

| 版本 | 日期 | 修改内容 |
|-----|------|---------|
| v1.0 | 2025-10-21 | 初始版本，包含所有核心接口和推送能力说明 |

---

**文档维护**：本文档将随 BlueKing Lite 版本更新而更新，建议定期查看最新版本。
